{% extends 'base.html' %}
{% load static %}

{% block head %}
<title>Crear nuevo menú del día</title>
{% endblock head %}

{% block content %}

<div id="contenedor-general" class="d-flex flex-column mx-4">

    <h3>Crear nuevo menú del día</h3>

    <form if="form-menu-nuevo" method="POST">

        {% csrf_token %}

        <div id="botones-menú" class="d-flex justify-content-end flex-wrap">
            <button id="btn-selec-bebidas" type="button" class="btn btn-warning mx-3" onclick="seleccionar('BE')">
                <i class="fas fa-coffee fa-lg">
                    Seleccionar todas las bebidas
                </i>
            </button>
            <button id="btn-selec-extras" type="button" class="btn btn-warning mx-3" onclick="seleccionar('EX')">
                <i class="fas fa-utensils fa-lg">
                    Seleccionar todos los extras
                </i>
            </button>
            <button id="btn-selec-sushis" type="button" class="btn btn-warning mx-3" onclick="seleccionar('SU')">
                <i class="fas fa-utensils fa-lg">
                    Seleccionar todos los sushis
                </i>
            </button>
            <button id="btn-copiar-comidas" type="button" class="btn btn-warning mx-3" onclick="copiar({{ menu_anterior }})">
                <i class="fas fa-copy fa-lg">
                    Copiar el menú anterior
                </i>
            </button>
        </div>

        <div class="table-responsive-xl">
            <table id="tabla-comida" class="table table-sm">

                <thead>
                    <tr>
                        <th>Nombre</th>
                        <th>Descripción</th>
                        <th>Tipo</th>
                        <th>Precio</th>
                        <th>¿Incluir?</th>
                    </tr>
                </thead>

                <tbody>
                    {% for platillo in platillos %}
                        <tr>
                            <td>
                                {{ platillo.nombre }}
                            </td>
                            <td>
                                {{ platillo.descripcion }}
                            </td>
                            <td>
                                {{ platillo.get_tipo_display }}
                            </td>
                            <td>
                                {% for precio in precios %}
                                    {% if platillo == precio.platillo %}
                                        {{ precio.precio }}
                                    {% endif %}
                                {% endfor %}
                            </td>
                            <td>
                                <input id="{{ platillo.nombre }}" name="{{ platillo.nombre }}" type="checkbox" class="custom-control-input checkbox check-{{ platillo.tipo }}">
                            </td>
                        </tr>
                    {% endfor %}
                </tbody>

            </table>
        </div>

        <div id="contenedor-botones" class="d-flex justify-content-end py-3">
            <button id="boton-nuevo-menu" type="submit" class="btn btn-primary btn-lg btn-warning">
                <i class="fas fa-file-alt fa-lg">
                    &Tab;Guardar Nuevo Menú del día
                </i>
            </button>
        </div>

    </form>

</div>
{% endblock content %}

{% block script %}
<script>
    //función para copiar los platillos de un menu anterior al que se está editando:
    //recibimos la lista de platillos de un menú
    //recorremos todos los checkboxes dados por clase_checkbox, y si su ID corresponde a uno de los platillos en el menú, marcalo.
    function copiar(menu){
        checkboxes = document.getElementsByClassName("checkbox");
        for (i=0; i<checkboxes.length; i++){
            for (j=0; j<menu.length; j++){
                if (checkboxes[i].id == menu[j]){
                    checkboxes[i].checked = true;
                }
            }
        }
    }

    //función para seleccionar todos los platillos de un tipo:
    //recibimos el tipo de platillos, buscamos los checkboxes de su clase, y los marcamos
    function seleccionar(tipo){
        checkboxes = document.getElementsByClassName("check-" + tipo);
        for (i=0; i<checkboxes.length; i++){
            checkboxes[i].checked = true;
        }
    }
</script>
{% endblock script %}
